{
    "containerDefinitions": [
        {
            "command": [
                "consul",
                "agent",
                "-dev",
                "-ui",
                "-client",
                "0.0.0.0",
                "-log-level=INFO"
            ],
            "essential": true,
            "image": "consul:1.13.1",
            "name": "consul",
            "portMappings": [
                {
                    "containerPort": 8300,
                    "hostPort": 8300
                },
                {
                    "containerPort": 8500,
                    "hostPort": 8500
                },
                {
                    "containerPort": 8600,
                    "hostPort": 8600
                }
            ]
        },
        {
            "environment": [
                {
                    "name": "INIT_SLEEP_SECONDS",
                    "value": "5"
                },
                {
                    "name": "CONSUL_URL",
                    "value": "consul"
                },
                {
                    "name": "CONSUL_PORT",
                    "value": "8500"
                }
            ],
            "essential": true,
            "image": "jhipster/consul-config-loader:v0.4.1",
            "mountPoints": [
                {
                    "containerPath": "/config",
                    "sourceVolume": "_Central-Server-Config"
                }
            ],
            "name": "consul-config-loader"
        },
        {
            "environment": [
                {
                    "name": "_JAVA_OPTIONS",
                    "value": "-Xmx512m -Xms256m"
                },
                {
                    "name": "SPRING_PROFILES_ACTIVE",
                    "value": "prod,api-docs"
                },
                {
                    "name": "MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED",
                    "value": "true"
                },
                {
                    "name": "SPRING_CLOUD_CONSUL_HOST",
                    "value": "consul"
                },
                {
                    "name": "SPRING_CLOUD_CONSUL_PORT",
                    "value": "8500"
                },
                {
                    "name": "SPRING_R2DBC_URL",
                    "value": "r2dbc:postgresql://dematinvoice-postgresql:5432/dematinvoice"
                },
                {
                    "name": "SPRING_LIQUIBASE_URL",
                    "value": "jdbc:postgresql://dematinvoice-postgresql:5432/dematinvoice"
                },
                {
                    "name": "SPRING_SECURITY_OAUTH2_CLIENT_PROVIDER_OIDC_ISSUER_URI",
                    "value": "http://keycloak:9080/realms/jhipster"
                },
                {
                    "name": "SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_OIDC_CLIENT_ID",
                    "value": "web_app"
                },
                {
                    "name": "SPRING_SECURITY_OAUTH2_CLIENT_REGISTRATION_OIDC_CLIENT_SECRET",
                    "value": "web_app"
                },
                {
                    "name": "JHIPSTER_SLEEP",
                    "value": "80"
                },
                {
                    "name": "SPRING_ELASTICSEARCH_URIS",
                    "value": "http://dematinvoice-elasticsearch:9200"
                },
                {
                    "name": "SPRING_CLOUD_STREAM_KAFKA_BINDER_BROKERS",
                    "value": "kafka:9092"
                }
            ],
            "essential": true,
            "image": "waelghannem/dematinvoice:latest",
            "name": "dematinvoice-app",
            "portMappings": [
                {
                    "containerPort": 8081,
                    "hostPort": 8081
                }
            ]
        },
        {
            "environment": [
                {
                    "name": "ES_JAVA_OPTS",
                    "value": "-Xms256m -Xmx256m"
                },
                {
                    "name": "discovery.type",
                    "value": "single-node"
                }
            ],
            "essential": true,
            "image": "docker.elastic.co/elasticsearch/elasticsearch:7.17.4",
            "name": "dematinvoice-elasticsearch",
            "portMappings": [
                {
                    "containerPort": 9200,
                    "hostPort": 9200
                },
                {
                    "containerPort": 9300,
                    "hostPort": 9300
                }
            ]
        },
        {
            "environment": [
                {
                    "name": "POSTGRES_USER",
                    "value": "dematinvoice"
                },
                {
                    "name": "POSTGRES_PASSWORD",
                    "value": ""
                },
                {
                    "name": "POSTGRES_HOST_AUTH_METHOD",
                    "value": "trust"
                }
            ],
            "essential": true,
            "image": "postgres:14.5",
            "name": "dematinvoice-postgresql",
            "portMappings": [
                {
                    "containerPort": 5432,
                    "hostPort": 5432
                }
            ]
        },
        {
            "environment": [
                {
                    "name": "KAFKA_BROKER_ID",
                    "value": "1"
                },
                {
                    "name": "KAFKA_ZOOKEEPER_CONNECT",
                    "value": "zookeeper:2181"
                },
                {
                    "name": "KAFKA_ADVERTISED_LISTENERS",
                    "value": "PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092"
                },
                {
                    "name": "KAFKA_LISTENER_SECURITY_PROTOCOL_MAP",
                    "value": "PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT"
                },
                {
                    "name": "KAFKA_INTER_BROKER_LISTENER_NAME",
                    "value": "PLAINTEXT"
                },
                {
                    "name": "KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR",
                    "value": "1"
                },
                {
                    "name": "KAFKA_ADVERTISED_HOST_NAME",
                    "value": "kafka"
                }
            ],
            "essential": true,
            "image": "confluentinc/cp-kafka:7.2.1",
            "name": "kafka",
            "portMappings": [
                {
                    "containerPort": 9092,
                    "hostPort": 9092
                }
            ]
        },
        {
            "command": [
                "start-dev --import-realm"
            ],
            "environment": [
                {
                    "name": "KC_DB",
                    "value": "dev-file"
                },
                {
                    "name": "KEYCLOAK_ADMIN",
                    "value": "admin"
                },
                {
                    "name": "KEYCLOAK_ADMIN_PASSWORD",
                    "value": "admin"
                },
                {
                    "name": "KC_FEATURES",
                    "value": "scripts"
                },
                {
                    "name": "KC_HTTP_PORT",
                    "value": "9080"
                },
                {
                    "name": "KC_HTTPS_PORT",
                    "value": "9443"
                }
            ],
            "essential": true,
            "image": "quay.io/keycloak/keycloak:19.0.1",
            "mountPoints": [
                {
                    "containerPath": "/opt/keycloak/data/import",
                    "sourceVolume": "_Realm-Config"
                }
            ],
            "name": "keycloak",
            "portMappings": [
                {
                    "containerPort": 9080,
                    "hostPort": 9080
                },
                {
                    "containerPort": 9443,
                    "hostPort": 9443
                }
            ]
        },
        {
            "environment": [
                {
                    "name": "ZOOKEEPER_CLIENT_PORT",
                    "value": "2181"
                },
                {
                    "name": "ZOOKEEPER_TICK_TIME",
                    "value": "2000"
                }
            ],
            "essential": true,
            "image": "confluentinc/cp-zookeeper:7.2.1",
            "name": "zookeeper"
        }
    ],
    "family": "",
    "volumes": [
        {
            "host": {
                "sourcePath": "./central-server-config"
            },
            "name": "_Central-Server-Config"
        },
        {
            "host": {
                "sourcePath": "./realm-config"
            },
            "name": "_Realm-Config"
        }
    ]
}